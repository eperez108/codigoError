<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: utils.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: utils.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>class Utils {
    static filtradoTags (tags) {
        return (tags.length === 2) &amp;&amp; tags[0].includes("isCriteriaOf") &amp;&amp; tags[1].includes("mark");
    }

    static normalizar (anotacionesGrupo, nota) {
        //Se obtienen las primeras anotaciones del grupo que fueron generados automaticamente
        var criteriosDeRubrica = _.filter(anotacionesGrupo, (value, key) => {return Utils.esNotaPreguntaTags(value.tags);})

        //Se agrupan por pregunta y se obtiene el valor maximo de cada una
        var puntuacionMaximaEjercicios = _(criteriosDeRubrica ).groupBy((d)=>d.tags[1]).map((puntuaciones, pregunta) => ({
            'pregunta': pregunta,
            'puntuacionMayor':  parseInt(_.maxBy(puntuaciones, function(o) { return parseInt(o.tags[0].slice(10)) }).tags[0].slice(10))
        })).value();

        //Suma las puntuaciones maximas
        var valorExamen=_.sumBy(puntuacionMaximaEjercicios, 'puntuacionMayor');

        return (nota*10)/valorExamen;
    }

    static esPreguntaNotaTags(tags) {
        return (tags.length===2) &amp;&amp; tags[0].includes("isCriteriaOf") &amp;&amp; tags[1].includes("mark");
    }

    /**
     * Devuelve TRUE si el array de tags tiene longitud 2 y la primera es la nota y la segunda la la pregunta. Estos corresponden a los criterios de rubrica que se crean al principio
     * @param tags lista de tags
     * @returns {boolean|*}
     */
    static esNotaPreguntaTags(tags) {
        return (tags.length===2) &amp;&amp; tags[0].includes("mark") &amp;&amp; tags[1].includes("isCriteriaOf");
    }

    //Funcion que obtiene las anotaciones (como maximo 200) ignorando las primeras n anotaciones (offset) del grupo pasado como parametro
    static obtenerAnotacionesAjaxGrupo(grupo,offset){
        var xhttp = new XMLHttpRequest();
        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 &amp;&amp; this.status == 200) {
                var anotacionesResto= JSON.parse(this.responseText);
                anotacionesGrupo=anotacionesGrupo.concat(anotacionesResto.rows);
            }
        };
        xhttp.open("GET", "https://hypothes.is/api/search?group="+grupo+"&amp;offset="+offset+"&amp;limit=200&amp;order=asc", false);
        xhttp.setRequestHeader("Authorization", "Bearer 6879-Q--ve1yLCItODnHueg4py6UT-qqq93bk-xgvra0-BVA");
        xhttp.send();
    }

}

module.exports = Utils</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="DOM.html">DOM</a></li><li><a href="HypothesisClientManager.html">HypothesisClientManager</a></li><li><a href="MarkAndGoVizForExamGroup.html">MarkAndGoVizForExamGroup</a></li><li><a href="SankeyDiagram.html">SankeyDiagram</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Jun 27 2018 18:46:02 GMT+0200 (CEST)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
